# crypton web frontend

## 機能

以下の機能を、Next.js、TypeScriptで実装すること。
なお、すべてクライアントサイドで動かすが、SSGのためにNext.jsを選択している。

### wasm

PGP関連の処理はwasmに依存する。
このwasmはWeb Workerで実装し、メインスレッドが固まることのないようにする。

### APIとの通信

- `../crypton-api` のエンドポイントを利用すること。
- fetch APIを用いること。
- baseUrlを変更できるようにすること。
- 適切なラッパーなどを作成することを厭わない。
- zodライブラリを用いてデシリアライズせよ。

### UI

#### 共通

- TailwindCSSを用いること。
- TailwindCSSの表記を用いて、レスポンシブ対応すること。
- TailwindCSSの記述を用いて、ダークモード対応すること。
- デザインを共通化できるところは極力共通化すること。
  - ボタンや入力欄などは、色以外については一般に共通化できる。
- borderなどは影などを用いて目立ちすぎず自然に表現すること。
- テーマカラーを選択でき、テーマカラーでほどほどに装飾を施す。

#### 機能

次のような機能を実装する。
なお、表示言語はデフォルトで英語、設定で日本語に切り替えられるようにする。

- 画面下のタブ選択をアイコンでできるようにする。
  - タブは、チャット、通話、プロフィール（自身のアイコン）
- 画面上には選択しているタブの名前を表示する。
  - ここの右側にはそれぞれアイコンを使ってボタンを表示する。

##### チャット

- 右上に四角とペンで新規チャット作成画面をおく。
- リストは最初に30件程度表示され、下にスクロールすると追加でロードされる。
- モバイル
  - チャットの相手がリストで表示される。
  - 個人相手であれば左にアイコン、その隣の上に名前、下に薄めの文字でステータスが表示される。
  - そうでなければ、参加者のアイコンを重ねてブラーをかけたアイコンと、設定したグループ名が用いられる。
  - 対象を選択すると、次にスレッド選択画面になる。スレッドのリストは名前のみ。
  - スレッド選択でチャット画面に移る。
- PC
  - 左側から、チャットグループ一覧、スレッド一覧、が細めの幅で続き、残りはチャット画面とする。
  - アイコンや表示名などはモバイルと一緒。
- チャット画面は、左にアイコン、右にアイコンの半分くらいの縦幅で名前、薄い文字で時刻を表示し、名前の下に文章が続く。
  - 連続したメッセージはアイコンと名前を都度表示させない。
  - 日にちを跨ぐ時は、横線と日にちを表示する。

##### プロフィール画面

プロフィール画面は次のような実装とする。

- アイコンは正方形の物をアップロードできるが、表示はrounded-fullで円形になる。
  - 透過もそのまま扱う。
- 右上にペンと歯車を表示し、それぞれプロフィール編集、設定画面を表示できる。
- 通常は編集不能なプロフィールが表示されるだけであるが、プロフィール編集ボタンを押すとそれぞれがテキストボックスになる。
  - アイコンは選択すると画像アップロード画面になる。
  - 編集モードでは右上のボタン配置は保存ボタンのみとなる。
- 公開鍵表示ボタンで、上から公開鍵のQRコード、コピーボタンが配置されたダイアログが表示される。

配置は

- モバイル
  - 上から、センタリングされたアイコン、ID、表示名、ステータス、プロフィール、公開鍵表示ボタンを配置する。
- PC
  - 左側に上からアイコン、ID、表示名、ステータス、右側に上からプロフィール、公開鍵表示ボタンを配置する。

##### 設定画面

上から順に、

- アカウント切替（グリッドでアイコンをならべる）
- アカウント追加（登録と同じ画面に遷移）
- テーマ設定
  - ダイアログを表示し、テーマカラーをギラギラしない程度の赤、緑、青、暗くて落ち着いた赤、緑、青から選択できる。
  - 全体の背景色はライト、ダークから選べる。
- API設定
  - baseUrlの変更をダイアログ表示。
  - 今後追加される可能性がある。
- ログアウト
  - 赤色ボタン
- 公開鍵削除
  - 事実上のアカウント削除
  - 赤色ボタン

### PWA対応

PWAに対応し、以下の機能を実装すること。

- モバイル、PCで専用アプリケーションとして振る舞うよう、ホーム画面追加、全画面表示ができること。
- メッセージをpush通知で受け取れること。
  - 可能な限り外部依存せず、有料サービスは避けること。
- push通知を復号し、名前、内容を通知に表示できること。
- 通話の通知はpush通知で受け取ること。
